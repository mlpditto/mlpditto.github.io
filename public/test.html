<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <title>Test Firebase</title>
</head>

<body style="padding: 20px; font-family: sans-serif;">
    <h2>üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase</h2>
    <div id="status">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö...</div>
    <hr>
    <div id="logs" style="background:#f0f0f0; padding:10px; border-radius:5px; font-family:monospace;"></div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>

    <script>
        function log(msg, color = 'black') {
            const div = document.getElementById('logs');
            div.innerHTML += `<div style="color:${color}">${msg}</div>`;
            console.log(msg);
        }

        try {
            log("1. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase...", "blue");
            // firebase is already initialized in firebase-config.js
            if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
            log("‚úÖ Initialize ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "green");

            const db = firebase.firestore();
            log("2. ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Database...", "blue");

            db.collection("system_test").add({
                message: "Test Connection",
                time: new Date().toString()
            }).then((docRef) => {
                log(`‚úÖ ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (ID: ${docRef.id})`, "green");
                document.getElementById('status').innerText = "üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Database ‡πÑ‡∏î‡πâ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå";
                document.getElementById('status').style.color = "green";
                document.getElementById('status').style.fontWeight = "bold";
            }).catch((error) => {
                log(`‚ùå ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`, "red");
                log(`Code: ${error.code}`, "red");
                document.getElementById('status').innerText = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î (‡∏î‡∏π Log ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)";
                document.getElementById('status').style.color = "red";
            });

        } catch (e) {
            log(`‚ùå Error ‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á: ${e.message}`, "red");
        }
    </script>
</body>

</html>